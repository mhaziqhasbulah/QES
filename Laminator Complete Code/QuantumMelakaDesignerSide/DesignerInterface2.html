<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Designer File Data Entry</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7f8;
            margin: 0;
            padding: 0;
        }

        h1 {
            text-align: center;
            padding: 20px;
            background-color: #34495e;
            color: white;
        }

        form {
            max-width: 600px;
            margin: 30px auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h3 {
            color: #34495e;
            border-bottom: 1px solid #dcdcdc;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        input[type="text"]:focus {
            border-color: #34495e;
            outline: none;
        }

        button {
            display: inline-block;
            padding: 12px 20px;
            font-size: 16px;
            background-color: #34495e;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #2c3e50;
        }

        .form-section {
            margin-bottom: 30px;
        }

        /* Preview Box */
        #previewBox {
            margin: 20px auto;
            padding: 20px;
            background: #e2f0f7;
            border: 1px solid #ccc;
            border-radius: 8px;
            max-width: 600px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            form {
                margin: 20px;
                padding: 20px;
            }

            input[type="text"] {
                margin-bottom: 15px;
            }

            button {
                width: 100%;
                font-size: 18px;
            }

            #previewBox {
                margin: 10px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <h1>Designer File Data Entry</h1>
    
    <form id="dataEntryForm">
        <!-- Section 1: Job Info -->
        <h3>Job Info</h3>
        <label for="jobcard">Jobcard:</label>
        <input type="text" id="jobcard" required><br><br>
        
        <label for="week">Week:</label>
        <input type="text" id="week" required><br><br>
        
        <label for="date">Date (YYYY-MM-DD):</label>
        <input type="text" id="date" pattern="\d{4}-\d{2}-\d{2}" required><br><br>

        <!-- Section 2: Sail and Product Info -->
        <h3>Sail and Product Info</h3>
        <label for="rig">Rig:</label>
        <input type="text" id="rig" required><br><br>

        <label for="finish_facilities">Finish Facilities:</label>
        <input type="text" id="finish_facilities" required><br><br>

        <label for="salesperson">Salesperson:</label>
        <input type="text" id="salesperson" required><br><br>

        <label for="sail_type">Sail Type:</label>
        <input type="text" id="sail_type" required><br><br>

        <label for="product_m">Product (M):</label>
        <input type="text" id="product_m" required><br><br>

        <!-- Section 3: Design and Measurements -->
        <h3>Design and Measurements</h3>
        <label for="layout_m_mx">Layout (M/MX):</label>
        <input type="text" id="layout_m_mx" required><br><br>

        <label for="patches_internal_external">Patches (Internal/External):</label>
        <input type="text" id="patches_internal_external" required><br><br>

        <label for="xply_angle">Xply Angle:</label>
        <input type="text" id="xply_angle" required><br><br>

        <label for="transverse_angle">Transverse Angle:</label>
        <input type="text" id="transverse_angle" required><br><br>

        <label for="number_of_panel">Number of Panels:</label>
        <input type="text" id="number_of_panel" required><br><br>

        <label for="area_m_2">Area (mÂ²):</label>
        <input type="text" id="area_m_2" required><br><br>

        <label for="dpi">DPI:</label>
        <input type="text" id="dpi" required><br><br>

        <!-- Section 4: Material Info -->
        <h3>Material Info</h3>
        <label for="stringing_film">Stringing Film:</label>
        <input type="text" id="stringing_film" required><br><br>

        <label for="stringing_film_code">Stringing Film Code:</label>
        <input type="text" id="stringing_film_code" required><br><br>

        <label for="laminate_film">Laminate Film:</label>
        <input type="text" id="laminate_film" required><br><br>

        <label for="laminate_film_code">Laminate Film Code:</label>
        <input type="text" id="laminate_film_code" required><br><br>

        <!-- Section 5: Additional Info -->
        <h3>Additional Info</h3>
        <label for="i_pure_corner">I-Pure Corner:</label>
        <input type="text" id="i_pure_corner"><br><br>

        <label for="i_pure_starfish">I-Pure Starfish:</label>
        <input type="text" id="i_pure_starfish"><br><br>

        <label for="batten_end">Batten End:</label>
        <input type="text" id="batten_end"><br><br>

        <label for="jellyfish">Jellyfish:</label>
        <input type="text" id="jellyfish"><br><br>

        <label for="remark">Remark:</label>
        <input type="text" id="remark"><br><br>

        <label for="stringer_id">Stringer ID:</label>
        <input type="text" id="stringer_id"><br><br>

        <label for="laminate_id">Laminator ID:</label>
        <input type="text" id="laminate_id"><br><br>

        <label for="presetid">Preset ID:</label>
        <input type="text" id="presetid"><br><br>

        <!-- Submit Button -->
        <button type="button" onclick="previewData()">Preview Data</button><br><br>
        <button type="button" onclick="submitData()">Submit Data</button>
    </form>

    <!-- Preview Section -->
    <div id="previewBox" style="display: none;">
        <h3>Preview Entered Data</h3>
        <div id="previewContent"></div>
    </div>

    <script>
        // Automatically add hyphens to the date input field as user types (YYYY-MM-DD format)
        document.getElementById('date').addEventListener('input', function (e) {
            const input = e.target.value.replace(/\D/g, '').slice(0, 8); // Remove non-numeric characters and limit to 8 digits
            let formattedDate = '';

            if (input.length >= 5) {
                formattedDate = input.slice(0, 4) + '-' + input.slice(4, 6) + '-' + input.slice(6, 8);
            } else if (input.length >= 3) {
                formattedDate = input.slice(0, 4) + '-' + input.slice(4, 6);
            } else {
                formattedDate = input;
            }

            e.target.value = formattedDate;
        });

        function previewData() {
            const data = {
                jobcard: document.getElementById('jobcard').value,
                week: document.getElementById('week').value,
                date: document.getElementById('date').value,
                rig: document.getElementById('rig').value,
                finish_facilities: document.getElementById('finish_facilities').value,
                salesperson: document.getElementById('salesperson').value,
                sail_type: document.getElementById('sail_type').value,
                product_m: document.getElementById('product_m').value,
                layout_m_mx: document.getElementById('layout_m_mx').value,
                patches_internal_external: document.getElementById('patches_internal_external').value,
                xply_angle: document.getElementById('xply_angle').value,
                transverse_angle: document.getElementById('transverse_angle').value,
                number_of_panel: document.getElementById('number_of_panel').value,
                area_m_2: document.getElementById('area_m_2').value,
                dpi: document.getElementById('dpi').value,
                stringing_film: document.getElementById('stringing_film').value,
                stringing_film_code: document.getElementById('stringing_film_code').value,
                laminate_film: document.getElementById('laminate_film').value,
                laminate_film_code: document.getElementById('laminate_film_code').value,
                i_pure_corner: document.getElementById('i_pure_corner').value,
                i_pure_starfish: document.getElementById('i_pure_starfish').value,
                batten_end: document.getElementById('batten_end').value,
                jellyfish: document.getElementById('jellyfish').value,
                remark: document.getElementById('remark').value,
                stringer_id: document.getElementById('stringer_id').value,
                laminate_id: document.getElementById('laminate_id').value,
                presetid: document.getElementById('presetid').value
            };

            //const previewBox = document.getElementById('previewBox');
            //const previewContent = document.getElementById('previewContent');
            //previewContent.innerHTML = JSON.stringify(data, null, 2);
            //previewBox.style.display = 'block';

            let previewContent = '';
            for (const key in data) {
                previewContent += `<p><strong>${key}:</strong> ${data[key]}</p>`;
            }

            document.getElementById('previewContent').innerHTML = previewContent;
            document.getElementById('previewBox').style.display = 'block';
        }

        function submitData() {
            const data = {
                jobcard: document.getElementById('jobcard').value,
                week: document.getElementById('week').value,
                date: document.getElementById('date').value,
                rig: document.getElementById('rig').value,
                finish_facilities: document.getElementById('finish_facilities').value,
                salesperson: document.getElementById('salesperson').value,
                sail_type: document.getElementById('sail_type').value,
                product_m: document.getElementById('product_m').value,
                layout_m_mx: document.getElementById('layout_m_mx').value,
                patches_internal_external: document.getElementById('patches_internal_external').value,
                xply_angle: document.getElementById('xply_angle').value,
                transverse_angle: document.getElementById('transverse_angle').value,
                number_of_panel: document.getElementById('number_of_panel').value,
                area_m_2: document.getElementById('area_m_2').value,
                dpi: document.getElementById('dpi').value,
                stringing_film: document.getElementById('stringing_film').value,
                stringing_film_code: document.getElementById('stringing_film_code').value,
                laminate_film: document.getElementById('laminate_film').value,
                laminate_film_code: document.getElementById('laminate_film_code').value,
                i_pure_corner: document.getElementById('i_pure_corner').value,
                i_pure_starfish: document.getElementById('i_pure_starfish').value,
                batten_end: document.getElementById('batten_end').value,
                jellyfish: document.getElementById('jellyfish').value,
                remark: document.getElementById('remark').value,
                stringer_id: document.getElementById('stringer_id').value,
                laminate_id: document.getElementById('laminate_id').value,
                presetid: document.getElementById('presetid').value
            };

            fetch('/submit_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(result => {
                alert(result.message);
                if (result.success) {
                    document.getElementById('dataEntryForm').reset();
                    document.getElementById('previewBox').style.display = 'none';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while submitting the data.');
            });
        }
    </script>
</body>
</html>
